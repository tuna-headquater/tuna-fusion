{{- if .Values.configmap.create -}}
apiVersion: v1
kind: ConfigMap
metadata:
  name: {{include "tuna-fusion-gitops-server.configmapName" .}}
data:
  application.yaml: |
    server:
      port: {{.Values.app.serverPort}}
    logging:
      level:
        ai.tuna.fusion: {{.Values.app.loggingLevel}}
    gitops:
      reposRootPath: /gits
      defaultBranch: refs/heads/main
      sourceArchiveHandler:
        folderOnFilesystem:
          localSourceArchiveRootPath: /archive
        zipArchiveOnLocalHttpServer:
          zipRepositoryRoot: /zips
          httpServerBaseUrl: {{include "shared.gitopsServerBaseurl" .}}
        type: {{.Values.app.sourceArchiveHandlerType}}
  {{- end }}